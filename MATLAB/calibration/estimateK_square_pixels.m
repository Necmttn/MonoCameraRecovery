function [w K] = estimateK_square_pixels(v1, v2, v3)

A = [v1(1)*v2(1)+v1(2)*v2(2) v1(1)/2+v2(1)/2 v1(2)/2+v2(2)/2 1; ...
     v1(1)*v3(1)+v1(2)*v3(2) v1(1)/2+v3(1)/2 v1(2)/2+v3(2)/2 1; ...
     v3(1)*v2(1)+v3(2)*v2(2) v3(1)/2+v2(1)/2 v3(2)/2+v2(2)/2 1];
 
 [~, ~, v] = svd(A);
 
 v = v(:,4);
 w = [v(1) 0 v(2)/2 ; 0 v(1) v(3)/2; v(2)/2 v(3)/2 v(4)];
 
 K = chol(w)^(-1);
 K = K./K(3,3);
    